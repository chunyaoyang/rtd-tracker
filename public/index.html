<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTD Tracker</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .vehicle { padding: 10px; border-bottom: 1px solid #ccc; }
        .route-badge { 
            background: #d32f2f; color: white; 
            padding: 2px 8px; border-radius: 4px; font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Real-Time RTD Tracker</h1>
    <div id="status">Loading data...</div>
    <div id="container"></div>

    <script>
        async function getBuses() {
            try {
                // RELATIVE PATH: No need for "https://..."
                const response = await fetch('/api/vehicles'); 
                const data = await response.json();
                
                const container = document.getElementById('container');
                const status = document.getElementById('status');
                
                container.innerHTML = ''; // Clear old data
                status.textContent = `Found ${data.length} vehicles active.`;

                data.forEach(bus => {
                    const div = document.createElement('div');
                    div.className = 'vehicle';
                    div.innerHTML = `
                        <span class="route-badge">${bus.routeId}</span>
                        <strong>Bus #${bus.id}</strong><br>
                        Lat: ${bus.lat}, Lng: ${bus.lng}
                    `;
                    container.appendChild(div);
                });

            } catch (err) {
                document.getElementById('status').textContent = "Error loading data.";
                console.error(err);
            }
        }

        // Run immediately
        getBuses();
        
        // Optional: Refresh every 30 seconds
        setInterval(getBuses, 30000);
    </script>
</body>
</html>